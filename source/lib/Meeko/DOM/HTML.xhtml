<?xml version="1.0"?>
<?xpl-require href="../ECMAScript5.xhtml"?>
<?xpl-require href="../DOM/System.xhtml"?>
<html>
<head>
<script>
<![CDATA[

Meeko.stuff.xplSystem.createNamespace("Meeko.DOM.HTML");
Meeko.DOM.HTML = (function() {

// make abbr and output parse on Internet Explorer
document.createElement("abbr");
document.createElement("output");

var HTMLCollection = function() {}
var HTMLOptionsCollection = function() {}
var HTMLDocument = function() {};
var HTMLElement = function() {}

if (document.documentElement.classList == null) {{

var HTML5Element = function(target) {
	if (null == target) return null; // TODO throw ??
	if (this == window) return null;
	else arguments.callee.prototype.xblCreate.call(this, target);
}
HTML5Element.prototype.xblCreate = function(target) {
	var getClassName = function() { return this.className; };
	var setClassName = function(val) { this.className = val; };
	this.classList = new DOMTokenList(getClassName.bind(target), setClassName.bind(target));
	Meeko.stuff.domSystem.bindInterface(target, this, ["classList"]);
}
HTML5Element.prototype.xblDestroy = function(target) {
	// FIXME Meeko.stuff.domSystem.unbindInterface()
	Meeko.stuff.domSystem.releaseInterface(target, this, ["classList"]);
	this.classList.xblDestroy(); // FIXME is this necessary
	this.classList = null;
}

Meeko.stuff.domSystem.addImplementation("HTMLElement", HTML5Element);
}}


return {
	HTMLCollection: HTMLCollection,
	HTMLOptionsCollection: HTMLOptionsCollection,
	HTMLDocument: HTMLDocument,
	HTMLElement: HTMLElement
};

})();

//Meeko.XPL.Namespace.enhance(window, Meeko.DOM.HTML);


]]>
</script>
</head>
</html>
