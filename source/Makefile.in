srcdir = @srcdir@
VPATH = @srcdir@

include @top_srcdir@/mk/gnu.bsdvars.mk

.SUFFIXES :
.SUFFIXES : .html .xhtml .js .xml .xpl 

TARGETS = SLAB.js jSLAB.js
BUILD_RESOURCES = libjoquer.js jSLAB_init.js

# Rules
all : build

depend : .depend

.depend :
	# FIXME
	# ${XPL} --make-depend ${PARAMS_CONFIG} XBL.xhtml > .depend
	# ${XPL} --make-depend ${PARAMS_CONFIG} XBLUI.xhtml >> .depend
	
build : ${TARGETS}

install: ${TARGETS}
	${INSTALL} ${.ALLSRC} ${pkglibexecdir}/

clean : 
	-rm ${TARGETS}
	-rm ${BUILD_RESOURCES}

SLAB.js : SLAB.xhtml lib/Meeko/DOM.xhtml

.xhtml.js : 
	${XPL} ${PARAMS_CONFIG} --path ${<D} ${<F} |\
	${JSMIN} - > ${.TARGET}

.xpl.js :
	${XPL2JS} ${.IMPSRC} > ${.TARGET}

jSLAB.js : SLAB.js ${BUILD_RESOURCES}
	cat ${.ALLSRC} |\
	${JSMIN} - > ${.TARGET}

libjoquer.js:
	${CURL} ${JOQUER_libexecdir}/libjoquer.js > ${.TARGET}

jSLAB_init.js:
	${CURL} ${JOQUER_libexecdir}/SLAB/init.js > ${.TARGET}

